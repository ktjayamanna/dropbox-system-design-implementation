version: '3'

services:
  dropbox-client:
    build:
      context: ../../
      dockerfile: deployment/docker/Dockerfile
    container_name: dropbox-client
    ports:
      - "8000:8000"
    volumes:
      - ../../client/server:/app/server
      - ../../client/db:/app/db
      - ../../client/scripts:/app/scripts
      - ../../client/requirements.txt:/app/requirements.txt
      - ../../client/config.py:/app/config.py
      - dropbox-data:/app/my_dropbox
      - db-data:/app/data
      - chunk-data:/app/tmp/chunk
    environment:
      - PYTHONPATH=/app
      - DATABASE_URL=sqlite:///./data/dropbox.db
    restart: unless-stopped

volumes:
  dropbox-data:
    driver: local
  db-data:
    driver: local
  chunk-data:
    driver: local
